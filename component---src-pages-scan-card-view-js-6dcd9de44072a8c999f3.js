(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{tGg3:function(e,t,a){"use strict";a.r(t),a.d(t,"ViewCard",(function(){return x}));var n=a("dI71"),r=(a("eiRb"),a("q1tI")),o=a.n(r),i=a("Wbzz"),s=a("/MKj"),l=a("Z3vd"),c=a("oCA+"),d=a("7oih"),m=a("tRbT"),u=a("kKAo"),h=a("+Isj"),p=a("iae6"),g=a("tr08"),f=a("C7fm"),v=a("YZMd"),E=a("lopY"),_=a("+n12"),b=a("XX3T"),w=a("gXA7"),y=a.n(w),C=a("lpWn"),S=a("wpBK"),k=a("vDqi"),D=a.n(k),O=a("CkNY"),F=(O.c,[{label:"Card Program",placeholder:"Card Program Name",type:"text",name:"program_name"},{label:"Card ID",placeholder:"Card ID Number",type:"text",name:"card_id"},{label:"Card Status",placeholder:"Status",type:"text",name:"available"}]),x=function(e){function t(t){var a;return(a=e.call(this,t)||this).onNext=function(){Object(i.navigate)("/scan-card/")},a.onSave=function(){},a.onCancel=function(){a.setFieldValues(),a.setState({openOrderConfirm:!1,showEditButton:!0,barcode:a.state.sel_card.barcode,webp:a.state.sel_card.compressed_face_image,photo:a.state.sel_card.face_image,showError:!1})},a.onConfirmOrder=function(){},a.onPrint=function(){},a.state={isLogin:!0,showEditButton:!0,formFields:F,openOrderConfirm:!1,resultTitle:"",openResultDlg:!1,loader:!1,isPhotoChanged:!1,webp:t.location.state.compressed_face_image,photo:t.location.state.face_image,showError:{},barcode:"",created_user:{},card_program:{},sel_card:{}},a}Object(n.a)(t,e);var a=t.prototype;return a.formFields=function(e,t){for(var a=this.state.formFields,n=0;n<a.length;n++)a[n].placeholder==t&&(a[n].value=e)},a.componentDidMount=function(){var e=this.props;e.dispatch,e.userData,e.basicData;this.setState({barcode:this.props.location.state.barcode}),this.getCreatedUser(),this.getCardProgram()},a.setFieldValues=function(){for(var e=this.state.card_program.program_template,t=F,a=0;a<e.length;a++)e[a].name=e[a].label.toString().toLowerCase().replace(/\s/g,"_"),t.push(e[a]);console.log("form fileds :",t),Object.entries(this.props.location.state).forEach((function(e){for(var a=e[0],n=e[1],r=0;r<t.length;r++)a==t[r].name&&(t[r].value=n)})),this.setState({formFields:t,sel_card:this.props.location.state})},a.getCreatedUser=function(){var e=this,t={Authorization:"Bearer "+localStorage.getItem("token")};return new Promise((function(a){var n=O.c+"/api/users/"+e.props.location.state.created_user;D.a.get(n,{headers:t}).then((function(t){var n=t.data.data;e.setState({created_user:n[0]}),a(n[0])})).catch((function(e){return console.log(e),Object(i.navigate)("/manage-cards/"),null})).finally((function(){}))}))},a.getCardProgram=function(){var e=this,t={Authorization:"Bearer "+localStorage.getItem("token")};return new Promise((function(a){var n=O.c+"/api/cardprogram/"+e.props.location.state.program_id;D.a.get(n,{headers:t}).then((function(t){var n=t.data.data;e.setState({card_program:n[0]},(function(){e.setFieldValues()})),a(n[0])})).catch((function(e){return console.log(e),Object(i.navigate)("/scan-card/"),null})).finally((function(){}))}))},a.getCardById=function(){var e=this,t={Authorization:"Bearer "+localStorage.getItem("token")};return new Promise((function(a){var n=O.c+"/api/cards/"+e.props.location.state.card_id;D.a.get(n,{headers:t}).then((function(t){var n=t.data.data;e.setState({sel_card:n[0]},(function(){e.setFieldValuesFromDB()})),a(n[0])})).catch((function(t){console.log(t),e.setFieldValues()})).finally((function(){}))}))},a.setFieldValuesFromDB=function(){for(var e=this.state.card_program.program_template,t=F,a=0;a<e.length;a++)e[a].name=e[a].label.toString().toLowerCase().replace(/\s/g,"_"),t.push(e[a]);console.log("form fileds :",t),Object.entries(this.state.sel_card).forEach((function(e){for(var a=e[0],n=e[1],r=0;r<t.length;r++)a==t[r].name&&(t[r].value=n)})),this.setState({formFields:t})},a.render=function(){var e=this,t=this.props,a=(t.userData,t.classes),n=t.transitionDuration,r=t.isDesktop,i={width:r?"50%":120,float:"right",marginLeft:5,marginRight:5,marginBottom:20,minWidth:120},s=r?{minWidth:150}:{minWidth:"90vw"};return o.a.createElement(d.a,{menuIndex:this.props.menuIndex},o.a.createElement(m.a,{container:!0,justify:"center",spacing:2,style:{minHeight:"100%"}},o.a.createElement(m.a,{item:!0,sm:4,xs:12,className:a.cardViewGridLeft},o.a.createElement(f.a,{editMode:!this.state.showEditButton,card_id:this.state.sel_card.card_id,program_id:this.state.card_program.program_id,first_name:this.state.sel_card.first_name,middle_name:this.state.sel_card.middle_name,last_name:this.state.sel_card.last_name,webp:this.state.sel_card.webp,photo:this.statesel_card.photo,ordered_date:this.state.sel_card.ordered_date,barcode:this.state.sel_card.barcode,onChanged:function(t,a){console.log("picture changed"),e.setState({isPhotoChanged:!0,webp:t,photo:a})}})),o.a.createElement(m.a,{item:!0,sm:5,xs:12,className:a.cardViewGrid,style:{marginRight:5}},o.a.createElement(u.a,{style:{padding:"0 10px"},elevation:0},this.state.formFields.map((function(t,a){var n=!0,r="";return t.name&&!e.state.showEditButton&&(n=!1,r=e.state.showError[t.name]),o.a.createElement(C.a,{key:_.a.getKey(),label:t.label,type:t.type,value:t.value,placeholder:t.placeholder,formFields:e.formFields.bind(e),showError:r,disable:n})})))),o.a.createElement(m.a,{item:!0,md:3,sm:12,className:a.cardViewGrid,style:s},o.a.createElement(u.a,{style:{padding:10,display:"flex",width:"100%",flexDirection:r?"column":"row",justifyContent:"center",alignItems:r?"stretch":"center",flexWrap:r?"nowrap":"wrap"},elevation:0},this.state.showEditButton?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,o.a.createElement(l.a,{variant:"contained",size:"medium",color:"primary",style:i,onClick:this.onNext},"Next Card")),o.a.createElement("div",null,o.a.createElement(l.a,{variant:"contained",size:"medium",color:"primary",style:i,onClick:this.onPrint},"Print")),o.a.createElement("div",null,o.a.createElement(l.a,{variant:"contained",size:"medium",color:"primary",style:i},"Write NFC")),o.a.createElement("div",null,o.a.createElement(l.a,{variant:"contained",size:"medium",color:"secondary",style:i},"Reject"))):o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,o.a.createElement(l.a,{variant:"contained",size:"medium",color:"primary",style:i,onClick:this.onSave,disabled:this.state.showEditButton},"update")),o.a.createElement("div",null,o.a.createElement(l.a,{variant:"contained",size:"medium",color:"primary",style:i,onClick:onCancel},"cancel")))))),o.a.createElement(v.a,{key:_.a.getKey(),in:this.state.showEditButton,timeout:n,style:{transitionDelay:"500ms"},unmountOnExit:!0},o.a.createElement(b.a,{"aria-label":"",style:{position:"fixed",bottom:20,right:30},color:"primary",onClick:function(){e.setState({showEditButton:!e.state.showEditButton})}},o.a.createElement("img",{src:y.a,style:{width:25,objectFit:"contain",marginTop:25}}))),o.a.createElement(S.a,{title:"You are about to update this card, Are you sure you want to do this?",open:this.state.openOrderConfirm,okTitle:"Update",onOk:this.onConfirmOrder,onCancel:this.onCancel}),o.a.createElement(S.a,{title:this.state.resultTitle,open:this.state.openResultDlg,okTitle:"OK",cancel:"",onOk:function(){e.setState({showEditButton:!0,openResultDlg:!1})},onCancel:function(){e.setState({showEditButton:!1,openResultDlg:!1})}}),o.a.createElement(h.a,{className:a.backdrop,open:this.state.loader},o.a.createElement(p.a,{color:"inherit"})))},t}(o.a.Component);t.default=function(e){var t=Object(s.useDispatch)(),a=(Object(s.useSelector)((function(e){return e.app.userData})),Object(c.a)()),n=Object(g.a)(),r={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},i=Object(E.a)("(min-width:1053px)");return o.a.createElement(x,Object.assign({},e,{menuIndex:0,dispatch:t,isDesktop:i,classes:a,transitionDuration:r}))}}}]);
//# sourceMappingURL=component---src-pages-scan-card-view-js-6dcd9de44072a8c999f3.js.map