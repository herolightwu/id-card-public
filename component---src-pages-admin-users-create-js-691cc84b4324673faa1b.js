(window.webpackJsonp=window.webpackJsonp||[]).push([[25,27],{GLvH:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return c}));var r=a("q1tI"),s=a.n(r),n=a("/MKj"),i=a("oCA+"),o=a("tr08"),d=a("lopY"),l=a("p6Lgq");function c(e){var t=Object(n.useDispatch)(),a=(Object(n.useSelector)((function(e){return e.app.userData})),Object(i.a)()),r=Object(o.a)(),c={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},u=Object(d.a)("(min-width:1053px)");return s.a.createElement(l.UserView,Object.assign({},e,{menuIndex:5,isAdd:!0,dispatch:t,isDesktop:u,classes:a,transitionDuration:c}))}},p6Lgq:function(e,t,a){"use strict";a.r(t),a.d(t,"UserView",(function(){return A}));var r=a("dI71"),s=a("q1tI"),n=a.n(s),i=a("Wbzz"),o=a("vDqi"),d=a.n(o),l=a("/MKj"),c=a("ofer"),u=a("Z3vd"),m=a("oCA+"),p=a("7oih"),h=a("tRbT"),g=a("kKAo"),f=a("tr08"),v=a("lopY"),w=a("+n12"),b=a("lpWn"),S=a("/4VY"),E=a("CkNY"),y=a("+QwO"),_=a.n(y),D=E.c+"/api",j=[{label:"Email",name:"email",placeholder:"Email Address",value:"cam@yahoo.com",type:"email"},{label:"First Name",placeholder:"First Name",name:"first_name",value:"Cam",type:"text"},{label:"Last Name",placeholder:"Last Name",name:"last_name",value:"Nguyen",type:"text"}],A=function(e){function t(t){var a;(a=e.call(this,t)||this).handleAddProgram=function(){a.setState({openCardPrograms:!0})},a.handleAddPermission=function(){a.setState({openPermissionDlg:!0})},a.removeCardPrograms=function(e){var t=a.state.cardPrograms.filter((function(t){return t!=e}));a.setState({cardPrograms:t})},a.removePermission=function(e){var t=a.state.permissions.filter((function(t){return t!=e}));a.setState({permissions:t})},a.handleReset=function(){var e=localStorage.getItem("token"),t=(localStorage.getItem("userId"),{Authorization:"Bearer "+e}),r=D+"/forgotpassword",s={email:j[0].value};a.setState({showLoader:!0}),d.a.put(r,s,{headers:t}).then((function(e){a.setState({showLoader:!1}),"unauthorized"===e.data.status?a.setState({showError:!0,message:e.data.message.toString()}):(a.setState({showLoader:!1}),a.alertRef.current?a.alertRef.current.showDialog("","A password reset email has been sent to the selected user",(function(){Object(i.navigate)("/admin/users")})):Object(i.navigate)("/admin/users"))})).catch((function(e){a.setState({showLoader:!1,showError:!0,message:e.toString()})}))},a.handleStatus=function(){var e=localStorage.getItem("token"),t=(localStorage.getItem("userId"),{Authorization:"Bearer "+e}),r=D+"/userEnabled/"+a.state.userID,s="disabled";a.state.disabledUser&&(s="enabled");var n={status:s};a.setState({showLoader:!0}),d.a.put(r,n,{headers:t}).then((function(e){a.setState({showLoader:!1}),"unauthorized"===e.data.status?a.setState({showError:!0,message:e.data.message.toString()}):(a.setState({showLoader:!1,disabledUser:!a.state.disabledUser}),a.alertRef.current?a.alertRef.current.showDialog("","This user status has set as "+s,(function(){Object(i.navigate)("/admin/users")})):Object(i.navigate)("/admin/users"))})).catch((function(e){a.setState({showLoader:!1,showError:!0,message:e.toString()})}))},a.onSave=function(){var e=localStorage.getItem("token"),t=localStorage.getItem("userId"),r=D+"/users/";a.props.isAdd||(r=D+"/admin/users/"+a.state.userID);for(var s={Authorization:"Bearer "+e},n=j,o=!0,l={},c=0;c<n.length;c++)n[c].value?0!=c||_.a.isEmail(n[c].value)||(l[n[c].name]="Invalid Email Address",o=!1):(l[n[c].name]="This field is required",o=!1);if(!a.props.isAdd){var u=a.props.location.state.email.split("@")[1],m=n[0].value;console.log("new domain : ",m),u!=m.split("@")[1]&&(l.email="Email domain can not be changed",o=!1)}if(a.setState({showError:l}),o){var p={program1:!0,program2:!0,program3:!0,program4:!0,program5:!0,program6:!0},h={cards_read:!0,cards_order:!0,cards_edit:!0,cards_print:!0,cards_reject:!0,nfc_write:!0},g={user_id:a.state.userID,user_email:j[0].value,first_name:j[1].value,last_name:j[2].value,user_status:a.props.isAdd?"enabled":a.state.status,user_permissions:h,user_programs:p,user_role:"Administrator",created_user:t,modified_user:t};console.log("body : ",g),a.props.isAdd?(a.setState({showLoader:!0}),d.a.post(r,g,{headers:s}).then((function(e){console.log("response : ",e),a.setState({showLoader:!1}),"unauthorized"===e.data.status?a.setState({showError:!0,message:e.data.message.toString()}):a.alertRef.current?a.alertRef.current.showDialog("","New user is created",(function(){Object(i.navigate)("/admin/users")})):Object(i.navigate)("/admin/users")})).catch((function(e){console.log("error : ",e),a.setState({showLoader:!1,showError:!0,message:e.toString()})}))):(a.setState({showLoader:!0}),d.a.put(r,g,{headers:s}).then((function(e){a.setState({showLoader:!1}),"unauthorized"===e.data.status?a.setState({showError:!0,message:e.data.message.toString()}):a.alertRef.current?a.alertRef.current.showDialog("","User information is updated",(function(){Object(i.navigate)("/admin/users")})):Object(i.navigate)("/admin/users")})).catch((function(e){a.setState({showLoader:!1,showError:!0,message:e.toString()})})))}};var r=localStorage.getItem("user_permissions");return a.state={isLogin:!0,showEditButton:!0,cardPrograms:(t.isAdd,["Program1","Program2","Program3"]),permissions:t.isAdd?r:["Cards_Read","Cards_Order","Cards_Edit","Cards_Print"],showLoader:!1,disabledUser:!1,userID:"",user_created_date:"01-01-2020",status:"disabled",formFields:j,showError:{}},a.alertRef=n.a.createRef(),a}Object(r.a)(t,e);var a=t.prototype;return a.componentDidMount=function(){var e=this.props;e.dispatch,e.userData,e.basicData;j[0].value=this.props.location.state.email,j[1].value=this.props.location.state.first_name,j[2].value=this.props.location.state.last_name,this.setState({userID:this.props.isAdd?0:this.props.location.state.id.toString(),status:this.props.location.state.user_status,role:this.props.location.state.user_role,user_created_date:this.props.location.state.created_date,disabledUser:"disabled"===this.props.location.state.user_status})},a.formFields=function(e,t){for(var a=0;a<j.length;a++)j[a].placeholder==t&&(j[a].value=e)},a.render=function(){var e=this,t=this.props,a=(t.userData,t.classes),r=(t.transitionDuration,t.isDesktop),s=(t.isAdd,{width:r?"50%":120,float:"right",marginLeft:5,marginRight:5,marginBottom:20,minWidth:180}),i=r?{minWidth:150}:{minWidth:"90vw"};return n.a.createElement(p.a,{menuIndex:this.props.menuIndex,loader:this.state.showLoader},n.a.createElement(h.a,{container:!0,justify:"center",spacing:2,style:{minHeight:"100%"}},n.a.createElement(h.a,{item:!0,sm:4,xs:12,className:a.cardViewGridLeft,style:{display:this.props.isAdd?"none":"inherit"}},this.props.isAdd?null:n.a.createElement("div",{style:{marginTop:20,paddingLeft:20}},n.a.createElement("div",null,n.a.createElement(c.a,{variant:"body1"},"User ID: ",this.state.userID)),n.a.createElement("div",{style:{marginTop:5,marginBottom:5}},n.a.createElement(c.a,{variant:"body1"},"Created: ",this.state.user_created_date)),n.a.createElement("div",null,n.a.createElement(c.a,{variant:"body1"},"Status: ",this.state.status)))),n.a.createElement(h.a,{item:!0,md:5,sm:12,xs:12,className:a.cardViewGrid,style:{marginRight:5}},n.a.createElement(g.a,{style:{padding:"0 10px"},elevation:0},j.map((function(t,a){var r=e.state.showError[t.name];return n.a.createElement(b.a,{key:w.a.getKey(),label:t.label,type:t.type,value:t.value,name:t.name,placeholder:t.placeholder,showError:r,formFields:e.formFields.bind(e)})})))),n.a.createElement(h.a,{item:!0,md:3,sm:12,className:a.cardViewGrid,style:i},n.a.createElement(g.a,{style:{padding:10,display:"flex",width:"100%",flexDirection:r?"column":"row",justifyContent:"center",alignItems:r?"stretch":"center",flexWrap:r?"nowrap":"wrap"},elevation:0},n.a.createElement("div",null,this.props.isAdd?n.a.createElement(u.a,{variant:"contained",size:"medium",color:"primary",style:s,onClick:this.onSave}," Create "):n.a.createElement(u.a,{variant:"contained",size:"medium",color:"primary",style:s,onClick:this.onSave}," Update ")),this.props.isAdd?null:n.a.createElement(n.a.Fragment,null,n.a.createElement("div",null,n.a.createElement(u.a,{variant:"contained",size:"medium",color:"primary",style:s,onClick:this.handleReset},"Reset password")),n.a.createElement("div",null,n.a.createElement(u.a,{variant:"contained",size:"medium",color:this.state.disabledUser?"primary":"secondary",style:s,onClick:this.handleStatus},this.state.disabledUser?"Enable User":"Disable User")))))),n.a.createElement(S.a,{ref:this.alertRef,okTitle:"done"}))},t}(n.a.Component);t.default=function(e){var t=Object(l.useDispatch)(),a=(Object(l.useSelector)((function(e){return e.app.userData})),Object(m.a)()),r=Object(f.a)(),s={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},i=Object(v.a)("(min-width:1053px)");return n.a.createElement(A,Object.assign({},e,{menuIndex:5,isAdd:!1,dispatch:t,isDesktop:i,classes:a,transitionDuration:s}))}}}]);
//# sourceMappingURL=component---src-pages-admin-users-create-js-691cc84b4324673faa1b.js.map