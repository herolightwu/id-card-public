(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{"3Qh7":function(e,t,r){"use strict";var a=r("q1tI"),o=r("5AJ6");t.a=Object(o.a)(a.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete")},"6MHB":function(e,t,r){"use strict";var a,o,n,i=r("8cO9"),s=r("IvzW"),c=r("REpN"),l=r("VZLR"),d=r("ckLD"),u=r("u5or"),p=r("yjCN"),f=r("V1zQ"),m=r("Bgjm"),h=r("Dqpf"),g=r("jekk").f,y=r("zDAn"),v=r("vAJC"),b=r("fMfZ"),E=r("QD2z"),w=r("F8ZZ"),C=r("E9J1"),_=C.enforce,A=C.get,O=c.Int8Array,T=O&&O.prototype,x=c.Uint8ClampedArray,S=x&&x.prototype,j=O&&v(O),I=T&&v(T),D=Object.prototype,R=c.TypeError,k=E("toStringTag"),z=w("TYPED_ARRAY_TAG"),B=i&&!!b&&"Opera"!==p(c.opera),F=!1,V={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},L={BigInt64Array:8,BigUint64Array:8},N=function(e){var t=v(e);if(d(t)){var r=A(t);return r&&u(r,"TypedArrayConstructor")?r.TypedArrayConstructor:N(t)}},P=function(e){if(!d(e))return!1;var t=p(e);return u(V,t)||u(L,t)};for(a in V)(n=(o=c[a])&&o.prototype)?_(n).TypedArrayConstructor=o:B=!1;for(a in L)(n=(o=c[a])&&o.prototype)&&(_(n).TypedArrayConstructor=o);if((!B||!l(j)||j===Function.prototype)&&(j=function(){throw R("Incorrect invocation")},B))for(a in V)c[a]&&b(c[a],j);if((!B||!I||I===D)&&(I=j.prototype,B))for(a in V)c[a]&&b(c[a].prototype,I);if(B&&v(S)!==I&&b(S,I),s&&!u(I,k))for(a in F=!0,g(I,k,{get:function(){return d(this)?this[z]:void 0}}),V)c[a]&&m(c[a],z,a);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:B,TYPED_ARRAY_TAG:F&&z,aTypedArray:function(e){if(P(e))return e;throw R("Target is not a typed array")},aTypedArrayConstructor:function(e){if(l(e)&&(!b||y(j,e)))return e;throw R(f(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,a){if(s){if(r)for(var o in V){var n=c[o];if(n&&u(n.prototype,e))try{delete n.prototype[e]}catch(i){try{n.prototype[e]=t}catch(l){}}}I[e]&&!r||h(I,e,r?t:B&&T[e]||t,a)}},exportTypedArrayStaticMethod:function(e,t,r){var a,o;if(s){if(b){if(r)for(a in V)if((o=c[a])&&u(o,e))try{delete o[e]}catch(n){}if(j[e]&&!r)return;try{return h(j,e,r?t:B&&j[e]||t)}catch(n){}}for(a in V)!(o=c[a])||o[e]&&!r||h(o,e,t)}},getTypedArrayConstructor:N,isView:function(e){if(!d(e))return!1;var t=p(e);return"DataView"===t||u(V,t)||u(L,t)},isTypedArray:P,TypedArray:j,TypedArrayPrototype:I}},"7Zau":function(e,t,r){e.exports=r.p+"static/card-front-532d3f869f48df198db699b193c0b91b.png"},"8cO9":function(e,t){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},PXjX:function(e,t,r){"use strict";var a=r("REpN"),o=r("e3+/"),n=r("JhOX"),i=r("5ja9"),s=r("N4st"),c=r("6MHB"),l=r("Tzlz"),d=r("vmxK"),u=r("9h/2"),p=r("efto"),f=c.aTypedArray,m=c.exportTypedArrayMethod,h=a.Uint16Array,g=h&&o(h.prototype.sort),y=!(!g||n((function(){g(new h(2),null)}))&&n((function(){g(new h(2),{})}))),v=!!g&&!n((function(){if(u)return u<74;if(l)return l<67;if(d)return!0;if(p)return p<602;var e,t,r=new h(516),a=Array(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,a[e]=e-2*t+3;for(g(r,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(r[e]!==a[e])return!0}));m("sort",(function(e){return void 0!==e&&i(e),v?g(this,e):s(f(this),function(e){return function(t,r){return void 0!==e?+e(t,r)||0:r!=r?-1:t!=t?1:0===t&&0===r?1/t>0&&1/r<0?1:-1:t>r}}(e))}),!v||y)},R88w:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var a=r("zLVn"),o=r("q1tI"),n=r.n(o),i=["pixel_data","width","height","onBarcode"];function s(e){var t=e.pixel_data,r=void 0===t?[]:t,s=e.width,c=e.height,l=e.onBarcode,d=Object(a.a)(e,i),u=Object(o.useRef)(null);return Object(o.useEffect)((function(){if(u.current){var e=u.current;!function(e){if(e.canvas.width=s+8,e.canvas.height=c+8,e.clearRect(0,0,e.canvas.width+8,e.canvas.height+8),e.fillStyle="white",e.fillRect(0,0,s+8,c+8),r.length>0){var t=e.createImageData(s,c),a=0;for(a=0;a<r.length;a++)t.data[a]=r[a];e.putImageData(t,4,4,0,0,s,c)}}(e.getContext("2d"));var t=e.toDataURL("image/jpeg");l(t)}}),[r,u]),n.a.createElement("canvas",Object.assign({ref:u},d))}},YTOV:function(e,t,r){var a=r("VZLR"),o=String,n=TypeError;e.exports=function(e){if("object"==typeof e||a(e))return e;throw n("Can't set "+o(e)+" as a prototype")}},ctqb:function(e,t,r){var a=r("JhOX");e.exports=!a((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},fMfZ:function(e,t,r){var a=r("e3+/"),o=r("m/aQ"),n=r("YTOV");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=a(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),t=r instanceof Array}catch(i){}return function(r,a){return o(r),n(a),t?e(r,a):r.__proto__=a,r}}():void 0)},"g+8C":function(e,t,r){"use strict";var a=r("REpN"),o=r("p7L2"),n=r("6MHB"),i=r("Ips1"),s=r("sm2e"),c=r("17+C"),l=r("JhOX"),d=a.RangeError,u=a.Int8Array,p=u&&u.prototype,f=p&&p.set,m=n.aTypedArray,h=n.exportTypedArrayMethod,g=!l((function(){var e=new Uint8ClampedArray(2);return o(f,e,{length:1,0:3},1),3!==e[1]})),y=g&&n.NATIVE_ARRAY_BUFFER_VIEWS&&l((function(){var e=new u(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));h("set",(function(e){m(this);var t=s(arguments.length>1?arguments[1]:void 0,1),r=c(e);if(g)return o(f,this,r,t);var a=this.length,n=i(r),l=0;if(n+t>a)throw d("Wrong length");for(;l<n;)this[t+l]=r[l++]}),!g||y)},hr0r:function(e,t,r){var a=r("yOJU"),o=RangeError;e.exports=function(e){var t=a(e);if(t<0)throw o("The argument can't be less than 0");return t}},lpWn:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var a=r("q1tI"),o=r.n(a),n=r("oCA+"),i=r("PsDL"),s=r("ydnR"),c=r("3Qh7");function l(e){var t=e.label,r=e.type,l=e.name,d=e.showError,u=e.value,p=e.placeholder,f=e.formFields,m=e.removable,h=e.editMode,g=e.onDelete,y=e.disable,v=void 0!==y&&y,b=Object(a.useState)(!1),E=b[0],w=b[1],C=Object(a.useState)(""),_=(C[0],C[1]),A=Object(a.useState)(!0),O=A[0],T=A[1],x=Object(n.a)();return o.a.createElement("div",{style:{backgroundColor:s.a.lightGray,padding:5,marginBottom:20,position:"relative"}},o.a.createElement("div",{className:x.labelText,style:{marginLeft:3}},t),o.a.createElement("input",{className:x.mainText,type:r,name:l,defaultValue:u,placeholder:p,onChange:function(e){_(e.target.value),function(e,t){void 0!==f&&f(e,t)}(e.target.value,p),e.target.value?T(!1):T(!0)},onFocus:function(){w(!0)},onBlur:function(){w(!1)},style:{width:"100%",borderWidth:0,backgroundColor:s.a.lightGray,outline:"none",borderBottomWidth:E?2:0,borderBottomColor:s.a.blue},disabled:v}),d&&O&&o.a.createElement("div",{className:x.errorText},d),m&&h?o.a.createElement(i.a,{style:{position:"absolute",right:0,top:10},onClick:g},o.a.createElement(c.a,null)):null)}},pTEV:function(e,t,r){"use strict";r.r(t),r.d(t,"OrderCard",(function(){return z}));var a=r("dI71"),o=(r("g+8C"),r("PXjX"),r("q1tI")),n=r.n(o),i=r("Wbzz"),s=r("vDqi"),c=r.n(s),l=r("/MKj"),d=r("Z3vd"),u=r("oCA+"),p=r("7oih"),f=r("tRbT"),m=r("kKAo"),h=r("+Isj"),g=r("iae6"),y=r("tr08"),v=r("ydnR"),b=r("lopY"),E=r("+n12"),w=r("lpWn"),C=r("HaE+"),_=r("o0o1"),A=r.n(_),O=r("kKU3"),T=r("7Zau"),x=r.n(T),S=r("wpBK"),j=r("CkNY");function I(e){var t=e.editMode,r=void 0===t||t,a=e.cardFrontImage,i=e.photoImage,s=e.onUploaded,c=e.photoError,l=Object(u.a)(),p=Object(y.a)(),f=(p.transitions.duration.enteringScreen,p.transitions.duration.leavingScreen,n.a.useState()),h=f[0],g=f[1],b=n.a.useState(!1),E=b[0],w=b[1],_=Object(o.useState)(void 0),T=_[0],I=_[1],D=Object(o.useState)(void 0),R=D[0],k=D[1],z=Object(o.useState)(!1),B=z[0],F=z[1];n.a.useEffect((function(){T&&R&&s&&s(T,R)}),[T,R]);var V=function(){var e=Object(C.a)(A.a.mark((function e(t){var r;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(t),i(t),w(!1),e.prev=3,e.next=6,j.b.generalPost("api/compress_image",{file:t});case 6:"success"==(r=e.sent).status&&(I(r.webp),k(t),F(!0)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.log("Ex at upload base64: ",e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}();return n.a.createElement(m.a,{elevation:0},n.a.createElement(m.a,{elevation:4},n.a.createElement("div",{style:{width:"100%",paddingTop:v.b.cardSize.paddingTop,position:"relative",borderRadius:7}},n.a.createElement("img",{src:a||x.a,ref:function(e){e||console.log("el is null")},style:{width:"100%",position:"absolute",top:0,left:0,borderRadius:7}}))),c&&!B&&n.a.createElement("div",{className:l.errorText,style:{marginTop:20}},c),n.a.createElement(m.a,{style:{marginTop:20,position:"relative",borderRadius:7,height:300},elevation:4},n.a.createElement("div",null,n.a.createElement("img",{src:h,style:{width:"100%",height:300,objectFit:"cover",marginBottom:0,borderRadius:7,display:h?"block":"none"}}),T&&n.a.createElement("div",{className:l.labelText,style:{marginTop:10,marginLeft:10}},"Compressed Image"),n.a.createElement("img",{src:"data:image/webp;base64,"+T,style:{width:"60%",objectFit:"contain",marginTop:10,borderRadius:7,display:T?"inherit":"none"}})),n.a.createElement(O.a,{in:r},n.a.createElement("div",{style:{position:"absolute",left:0,right:0,bottom:0,top:0,borderRadius:7,backgroundColor:r?v.a.opacityBlack:v.a.transparent,display:"flex",justifyContent:"center",alignItems:"center"}},n.a.createElement(d.a,{style:{color:v.a.white},onClick:function(){w(!0)}},"Add a photo")))),n.a.createElement(S.c,{open:E,title:"Add a photo?",handleClose:function(){w(!1)},onResult:V}))}var D=r("R88w"),R=j.c+"/api",k=[],z=function(e){function t(t){var r;return(r=e.call(this,t)||this).onSave=function(){for(var e=localStorage.getItem("token"),t=localStorage.getItem("userId"),a=j.a+"/api/encode/",o={Authorization:"Bearer "+e},n=r.state.formFields,i=!0,s={},l=0;l<n.length;l++)n[l].value||"Middle Name"==n[l].placeholder||"Address 2"==n[l].placeholder||(s[n[l].name]="This field is required",i=!1);if(r.setState({showError:s}),i)if(r.state.webp&&r.state.uploadedPicture){for(var d={},u={},p={},f=0;f<n.length;f++)n[f].extend?p[n[f].name]=n[f].value:u[n[f].name]=n[f].value;d.code_fields=u,d.server_fields=p,d.compressed_image=r.state.webp,d.program_id=r.props.selCard.program_id,d.created_user=t,d.modified_user=t,d.available=!0;var m={};m.message=d,m.matrixsize=r.props.selCard.matrix_size,m.compression=r.props.selCard.compression,m.edac=r.props.selCard.edac,c.a.post(a,m,{headers:o}).then((function(e){"success"===e.data.status?(r.setState({encodedData:e.data.data}),r.showVericode(e.data.data)):r.setState({showError:!0,message:e.data.message.toString()})})).catch((function(e){r.setState({showError:!0})}))}else r.setState({photoError:"Please pick a facial photo"})},r.onConfirmOrder=function(){for(var e=localStorage.getItem("token"),t=localStorage.getItem("userId"),a=R+"/cards/",o={Authorization:"Bearer "+e},n=r.state.formFields,i={},s={},l={},d=0;d<n.length;d++)n[d].extend?l[n[d].name]=n[d].value:s[n[d].name]=n[d].value;i.face_image=r.state.uploadedPicture,i.compressed_face_image=r.state.webp,i.program_id=r.props.selCard.program_id,i.code_fields=s,i.server_fields=l,i.barcode=r.state.encodedData,i.nfc_fields="",i.created_user=t,i.modified_user=t,i.available=!0,c.a.post(a,i,{headers:o}).then((function(e){console.log("response : ",e),"unauthorized"===e.data.status?r.setState({loader:!1,showError:!0,message:e.data.message.toString()}):r.setState({resultTitle:"Your card has been ordered. Continue order?",openResultDlg:!0,loader:!1,showCodeLabel:!1,barcode:""})})).catch((function(e){r.setState({loader:!1,showError:!0,message:e.toString()})})),r.setState({loader:!0,openOrderConfirm:!1})},r.onDone=function(){r.setState({isLogin:!0,showEditButton:!0,openOrderConfirm:!1,resultTitle:"",openResultDlg:!1,loader:!1,formFields:k,photoImage:"",webp:"",uploadedPicture:"",showError:{},photoError:"",encodedData:"",vericodeData:"",barcode:"",showCodeLabel:!1}),location.reload()},r.onCancel=function(){r.onDone(),Object(i.navigate)("/manage-cards/")},k=r.props.selCard.program_template,r.state={isLogin:!0,showEditButton:!0,openOrderConfirm:!1,resultTitle:"",openResultDlg:!1,loader:!1,formFields:k,photoImage:"",webp:"",uploadedPicture:"",showError:{},photoError:"",encodedData:"",vericodeData:"",barcode:"",showCodeLabel:!1},r}Object(a.a)(t,e);var r=t.prototype;return r.photoImage=function(e){console.log(e),this.setState({photoImage:e})},r.formFields=function(e,t){for(var r=this.state.formFields,a=0;a<r.length;a++)r[a].placeholder==t&&(r[a].value=e)},r.componentDidMount=function(){var e=this.props,t=(e.dispatch,e.userData,e.basicData,e.selCard);k=t.program_template;for(var r=0;r<k.length;r++)k[r].name=k[r].label.toString().toLowerCase().replace(/\s/g,"_");console.log("template : ",k),this.setState({formFields:k})},r.showVericode=function(e){var t=this;this.setState({loader:!0});var r=114*v.b.barCode.size_per_pixel,a=r*r*v.b.barCode.color_size;console.log("buffer size : ",a);for(var o=new ArrayBuffer(a),n=new Uint8Array(o),i=0,s=0;s<r;s++){i=s*r*v.b.barCode.color_size;for(var c=0;c<r*v.b.barCode.color_size;c+=v.b.barCode.color_size){var l=c/(v.b.barCode.size_per_pixel*v.b.barCode.color_size);"1"===e[parseInt(l)+114*parseInt(s/v.b.barCode.size_per_pixel)]?(n[i+c]=0,n[i+c+1]=0,n[i+c+2]=0,n[i+c+3]=255):(n[i+c]=255,n[i+c+1]=255,n[i+c+2]=255,n[i+c+3]=255)}}this.setState({vericodeData:n,showCodeLabel:!0}),setTimeout((function(){t.setState({openOrderConfirm:!0,loader:!1})}),1500)},r.render=function(){var e=this,t=this.props,r=(t.userData,t.classes),a=(t.transitionDuration,t.isDesktop),o=t.selCard,i={width:a?"50%":120,float:"right",marginLeft:5,marginRight:5,marginBottom:20,minWidth:120},s=a?{minWidth:150}:{minWidth:"90vw"};return n.a.createElement(p.a,{menuIndex:2},n.a.createElement(f.a,{container:!0,justify:"center",spacing:2},n.a.createElement(f.a,{item:!0,sm:4,xs:12,className:r.cardViewGridLeft},n.a.createElement(I,{cardFrontImage:o.front,photoImage:this.photoImage.bind(this),onUploaded:function(t,r){e.setState({webp:t,uploadedPicture:r})},photoError:this.state.photoError})),n.a.createElement(f.a,{item:!0,sm:5,xs:12,className:r.cardViewGrid,style:{marginRight:5}},n.a.createElement(m.a,{style:{padding:"0 10px"},elevation:0},k.map((function(t,r){var a=e.state.showError[t.name];return n.a.createElement(w.a,{key:E.a.getKey(),label:t.label,type:t.type,value:t.value,name:t.name,placeholder:t.placeholder,showError:a,formFields:e.formFields.bind(e)})})))),n.a.createElement(f.a,{item:!0,md:3,sm:12,className:r.cardViewGrid,style:s},n.a.createElement(m.a,{style:{padding:10,display:"flex",width:"100%",flexDirection:a?"column":"row",justifyContent:"center",alignItems:a?"stretch":"center",flexWrap:a?"nowrap":"wrap"},elevation:0},n.a.createElement("div",null,n.a.createElement(d.a,{variant:"contained",size:"medium",color:"primary",style:i,onClick:this.onSave},"save")),this.state.showCodeLabel&&n.a.createElement("div",{className:r.labelText,style:{marginTop:30,marginLeft:50}},"Vericode Image"),n.a.createElement("div",{style:{width:"100%",objectFit:"contain",justifyContent:"center",marginTop:"10px",display:this.state.vericodeData?"inherit":"none"}},n.a.createElement(D.a,{pixel_data:this.state.vericodeData,width:114*v.b.barCode.size_per_pixel,height:114*v.b.barCode.size_per_pixel,onBarcode:function(t){e.setState({barcode:t})}}))))),n.a.createElement(S.a,{title:"You are about to order a card, Are you sure you want to do this?",open:this.state.openOrderConfirm,okTitle:"Order",onOk:this.onConfirmOrder,onCancel:function(){e.setState({openOrderConfirm:!1})}}),n.a.createElement(S.a,{title:this.state.resultTitle,open:this.state.openResultDlg,okTitle:"DONE",cancel:"",onOk:this.onDone,onCancel:this.onCancel}),n.a.createElement(h.a,{className:r.backdrop,open:this.state.loader},n.a.createElement(g.a,{color:"inherit"})))},t}(n.a.Component);t.default=function(e){var t=Object(l.useDispatch)(),r=(Object(l.useSelector)((function(e){return e.app.userData})),Object(u.a)()),a=Object(l.useSelector)((function(e){return e.app.selCard})),o=Object(y.a)(),i={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},s=Object(b.a)("(min-width:1053px)");return n.a.createElement(z,Object.assign({},e,{selCard:a,menuIndex:2,dispatch:t,isDesktop:s,classes:r,transitionDuration:i}))}},sm2e:function(e,t,r){var a=r("hr0r"),o=RangeError;e.exports=function(e,t){var r=a(e);if(r%t)throw o("Wrong offset");return r}},vAJC:function(e,t,r){var a=r("u5or"),o=r("VZLR"),n=r("17+C"),i=r("uFM1"),s=r("ctqb"),c=i("IE_PROTO"),l=Object,d=l.prototype;e.exports=s?l.getPrototypeOf:function(e){var t=n(e);if(a(t,c))return t[c];var r=t.constructor;return o(r)&&t instanceof r?r.prototype:t instanceof l?d:null}}}]);
//# sourceMappingURL=component---src-pages-order-card-order-js-842fa0c1fc81200addfc.js.map