(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{hCFf:function(e,t,a){"use strict";a.r(t);var n=a("dI71"),o=(a("eiRb"),a("q1tI")),r=a.n(o),c=a("Wbzz"),i=a("/MKj"),s=a("oCA+"),l=a("7oih"),u=a("HaE+"),d=a("o0o1"),p=a.n(d),g=a("vDqi"),m=a.n(g),h=a("kKAo"),f=a("Z3vd"),v=a("S7Fk"),b=a.n(v),w=a("ydnR"),x=a("CkNY"),k=(a("Ov40"),{width:600,height:600,facingMode:"user"});function j(e){var t=r.a.useState(),a=t[0],n=t[1],i=Object(o.useState)({x:0,y:0}),s=(i[0],i[1],Object(o.useState)(1)),l=(s[0],s[1],Object(o.useState)(null)),d=(l[0],l[1],Object(o.useState)(null));d[0],d[1];Object(o.useEffect)((function(){null!=navigator.mediaDevices.getUserMedia?"false"==localStorage.getItem("camera_access")&&navigator.mediaDevices.getUserMedia({audio:!0,video:!0},(function(e){e.getTracks().forEach((function(e){return e.stop()})),localStorage.setItem("camera_access","true")}),(function(e){return console.log(e)})):localStorage.setItem("camera_access","false")})),Object(o.useEffect)((function(){setTimeout((function(){g()}),5e3)}),[a]);var g=r.a.useCallback(Object(u.a)(p.a.mark((function t(){var a,o;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==j.current){t.next=15;break}return a=j.current.getScreenshot(),console.log("captured image :",a),t.prev=3,t.next=6,v(a);case 6:o=t.sent,console.log("state : ",o),o.length>600?e.onDetected(o):n(a),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(3),console.log("error : ",t.t0),n(null);case 15:case"end":return t.stop()}}),t,null,[[3,11]])}))),[j]),v=function(e){return new Promise((function(t,a){if(e){var n=localStorage.getItem("token"),o=(localStorage.getItem("userId"),x.a+"/api/decode/"),r={Authorization:"Bearer "+n},c={};c.base64image=e,c.matrixsize=114,c.samplewidth=4,c.pixelspercell=4,c.edac=2,console.log("body : ",c),m.a.post(o,c,{headers:r}).then((function(e){console.log("response : ",e),"Unauthorized"===e.data.status?a("unauthorized"):t(e.data.data)})).catch((function(e){a("wrong vericode")}))}else a("wrong vericode")}))},j=r.a.useRef(null);return r.a.createElement(h.a,{elevation:0,style:{width:"80vw",height:"80vw",maxWidth:600,maxHeight:600,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},r.a.createElement("div",{style:{marginTop:30,position:"relative"}},r.a.createElement(b.a,{audio:!1,height:"100%",ref:j,screenshotFormat:"image/jpeg",width:"100%",videoConstraints:k}),r.a.createElement("div",{style:{position:"absolute",top:0,left:0,textAlign:"center",width:"100%",height:"10%",backgroundColor:w.a.opacityBlack,zIndex:1e3}}),r.a.createElement("div",{style:{position:"absolute",top:"90%",left:0,width:"100%",height:"10%",backgroundColor:w.a.opacityBlack,zIndex:1001,textAlign:"center"}},r.a.createElement(f.a,{variant:"text",style:{color:"black",paddingTop:"10%"},onClick:function(){Object(c.navigate)("/order-card/")}},"Click Here to Cancel")),r.a.createElement("div",{style:{position:"absolute",top:"10%",left:0,width:"10%",height:"80%",backgroundColor:w.a.opacityBlack,zIndex:1e3}}),r.a.createElement("div",{style:{position:"absolute",top:"10%",left:"90%",width:"10%",height:"80%",backgroundColor:w.a.opacityBlack,zIndex:1e3}}),r.a.createElement("div",{style:{position:"absolute",top:"10%",left:"10%",border:"1px solid green",width:"80%",height:"80%",zIndex:1e3,textAlign:"center"}})))}var y=function(e){function t(t){var a;return(a=e.call(this,t)||this).onTap=function(){Object(c.navigate)("/scan-card/view")},a.gotoView=function(e){console.log("card data : ",e),Object(c.navigate)("/scan-card/view",{state:e})},a.state={isLogin:!0,card_programs:[]},a}Object(n.a)(t,e);var a=t.prototype;return a.loadCardTemplate=function(){var e=this,t={Authorization:"Bearer "+localStorage.getItem("token")};return new Promise((function(a){setTimeout((function(){var n=x.c+"/api/allcardprograms";m.a.get(n,{headers:t}).then((function(t){var n=t.data.data.map((function(e){return{front:e.card_image_front,program_id:e.program_id,program_name:e.program_name,matrix_size:e.matrix_size,edac:e.edac,compression:e.compression,pxpcw:e.pxpcw,sample_width:e.sample_width,logo:e.logo,program_template:e.program_template,created_date:e.created_date}}));e.setState({card_programs:n}),a(n)})).catch((function(e){return console.log(e),Object(c.navigate)("/scan-card/"),null})).finally((function(){}))}),500*Math.random()+100)}))},a.componentDidMount=function(){var e=this.props;e.dispatch,e.userData,e.basicData;this.loadCardTemplate()},a.render=function(){var e=this.props;e.userData,e.classes;return r.a.createElement(l.a,{menuIndex:0},r.a.createElement(j,{onClick:this.onTap,onDetected:function(e){gotoView(e)}}))},t}(r.a.Component);t.default=function(e){var t=Object(i.useDispatch)(),a=Object(i.useSelector)((function(e){return e.app.userData})),n=Object(s.a)();return r.a.createElement(y,Object.assign({},e,{dispatch:t,userData:a,classes:n}))}}}]);
//# sourceMappingURL=component---src-pages-scan-card-index-js-d288977dbd2ae8c5a958.js.map