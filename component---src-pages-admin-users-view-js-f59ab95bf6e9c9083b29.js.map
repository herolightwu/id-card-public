{"version":3,"sources":["webpack:///./src/pages/admin/users/view.js"],"names":["API_URL","serverURL","formFields","label","name","placeholder","value","type","UserView","props","handleAddProgram","setState","openCardPrograms","handleAddPermission","openPermissionDlg","removeCardPrograms","one","newList","state","cardPrograms","filter","title","removePermission","permissions","handleReset","token","localStorage","getItem","headers","urlAPI","body","email","showLoader","axios","put","then","response","data","status","showError","message","toString","alertRef","current","showDialog","navigate","catch","error","handleStatus","userID","uStatus","disabledUser","onSave","userid","isAdd","fields","isValid","newShowError","i","length","validator","isEmail","old_domain","location","split","newemail","console","log","jsprograms","jspermissions","user_id","user_email","first_name","last_name","user_status","user_permissions","user_programs","user_role","created_user","modified_user","post","isLogin","showEditButton","user_created_date","React","createRef","componentDidMount","this","dispatch","userData","basicData","id","role","created_date","val","render","classes","isDesktop","transitionDuration","btnStyle","width","float","marginLeft","marginRight","marginBottom","minWidth","rightGridStyle","menuIndex","loader","container","justify","spacing","style","minHeight","item","sm","xs","className","cardViewGridLeft","display","marginTop","paddingLeft","variant","md","cardViewGrid","padding","elevation","map","index","showErr","key","Utils","getKey","bind","flexDirection","justifyContent","alignItems","flexWrap","size","color","onClick","ref","okTitle","Component","useDispatch","useSelector","app","useStyles","theme","useTheme","enter","transitions","duration","enteringScreen","exit","leavingScreen","useMediaQuery"],"mappings":"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","file":"component---src-pages-admin-users-view-js-f59ab95bf6e9c9083b29.js","sourcesContent":["import React from 'react'\r\nimport { navigate } from 'gatsby'\r\nimport axios from 'axios'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Button from '@material-ui/core/Button'\r\nimport useStyles from '../../../utils/styles'\r\n\r\nimport { MainLayout } from '../../../components/Layout'\r\nimport {\r\n  Grid,\r\n  Paper,\r\n  useTheme,\r\n} from '@material-ui/core'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport Utils from '../../../utils/utils'\r\nimport FilledTextInput from '../../../components/scan-card/FilledTextInput'\r\nimport AlertDialog from '../../../components/Dialog/AlertDialog'\r\nimport { serverURL } from '../../../utils/RestAPI'\r\nimport validator from 'validator'\r\n\r\nconst API_URL = serverURL + '/api';\r\n\r\nvar formFields = [\r\n  {\r\n    label: 'Email',\r\n    name: 'email',\r\n    placeholder: 'Email Address',\r\n    value:'cam@yahoo.com',\r\n    type: 'email',\r\n  },\r\n  {\r\n    label: 'First Name',\r\n    placeholder: 'First Name',\r\n    name: 'first_name',\r\n    value:'Cam',\r\n    type: 'text',\r\n  },\r\n\r\n  {\r\n    label: 'Last Name',\r\n    placeholder: 'Last Name',\r\n    name: 'last_name',\r\n    value:'Nguyen',\r\n    type: 'text',\r\n  },\r\n]\r\n\r\nexport class UserView extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    const permissions = localStorage.getItem('user_permissions')\r\n\r\n    this.state = {\r\n      isLogin: true,\r\n      showEditButton: true,\r\n      cardPrograms: props.isAdd\r\n        ? ['Program1', 'Program2', 'Program3']\r\n        : ['Program1', 'Program2', 'Program3'],\r\n      permissions: props.isAdd\r\n        ? permissions\r\n        : ['Cards_Read', 'Cards_Order', 'Cards_Edit', 'Cards_Print'],\r\n      showLoader: false,\r\n      disabledUser: false,\r\n      userID: '',\r\n      user_created_date: '01-01-2020',\r\n      status:'disabled',\r\n      formFields: formFields,\r\n      showError:{},\r\n    }\r\n\r\n    this.alertRef = React.createRef()\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { dispatch, userData, basicData } = this.props\r\n    formFields[0].value = this.props.location.state.email;\r\n    formFields[1].value = this.props.location.state.first_name;\r\n    formFields[2].value = this.props.location.state.last_name;\r\n\r\n    this.setState({\r\n      userID: this.props.isAdd ? 0 : this.props.location.state.id.toString(),\r\n      status: this.props.location.state.user_status,\r\n      role: this.props.location.state.user_role,\r\n      user_created_date: this.props.location.state.created_date,\r\n      disabledUser: this.props.location.state.user_status === 'disabled',\r\n    })\r\n\r\n  }\r\n\r\n  handleAddProgram = () => {\r\n    this.setState({\r\n      openCardPrograms: true,\r\n    })\r\n  }\r\n\r\n  handleAddPermission = () => {\r\n    this.setState({\r\n      openPermissionDlg: true,\r\n    })\r\n  }\r\n\r\n  removeCardPrograms = one => {\r\n    const newList = this.state.cardPrograms.filter(title => {\r\n      return title != one\r\n    })\r\n    this.setState({\r\n      cardPrograms: newList,\r\n    })\r\n  }\r\n\r\n  removePermission = one => {\r\n    const newList = this.state.permissions.filter(title => {\r\n      return title != one\r\n    })\r\n    this.setState({\r\n      permissions: newList,\r\n    })\r\n  }\r\n\r\n  handleReset = () => {\r\n    const token = localStorage.getItem('token');\r\n    const userid = localStorage.getItem('userId');\r\n    const beartoken = \"Bearer \" + token;\r\n    const headers = { \r\n      'Authorization': beartoken\r\n    };\r\n    \r\n    const urlAPI = API_URL + '/forgotpassword'\r\n\r\n    const body = {\r\n      email: formFields[0].value,\r\n    };\r\n\r\n    this.setState({ showLoader: true })\r\n    axios.put(urlAPI, body, { headers })\r\n        .then(response => {\r\n          this.setState({ \r\n            showLoader: false\r\n           })\r\n          if(response.data.status ==='unauthorized'){\r\n            this.setState({\r\n              showError:true,\r\n              message: response.data.message.toString()\r\n            })\r\n          } else{\r\n            this.setState({ showLoader: false })\r\n            if (this.alertRef.current) {\r\n              this.alertRef.current.showDialog('', 'A password reset email has been sent to the selected user', () => {\r\n                navigate('/admin/users')\r\n              })\r\n            } else {\r\n              navigate('/admin/users')\r\n            }\r\n          }\r\n        })\r\n        .catch(error => {\r\n          this.setState({ \r\n            showLoader: false,\r\n            showError:true,\r\n            message: error.toString()\r\n           })\r\n        })  \r\n    \r\n  }\r\n\r\n  handleStatus = () => {\r\n    const token = localStorage.getItem('token');\r\n    const userid = localStorage.getItem('userId');\r\n    const beartoken = \"Bearer \" + token;\r\n    const headers = { \r\n      'Authorization': beartoken\r\n    };\r\n    \r\n    const urlAPI = API_URL + '/userEnabled/' + this.state.userID\r\n    let uStatus = 'disabled'\r\n    if (this.state.disabledUser){\r\n      uStatus = 'enabled'\r\n    }\r\n\r\n    const body = {\r\n      status: uStatus\r\n    };\r\n\r\n    this.setState({ showLoader: true })\r\n    axios.put(urlAPI, body, { headers })\r\n        .then(response => {\r\n          this.setState({ \r\n            showLoader: false\r\n           })\r\n          if(response.data.status ==='unauthorized'){\r\n            this.setState({\r\n              showError:true,\r\n              message: response.data.message.toString()\r\n            })\r\n          } else{\r\n            this.setState({ showLoader: false, disabledUser: !this.state.disabledUser })\r\n            if (this.alertRef.current) {\r\n              this.alertRef.current.showDialog('', 'This user status has set as ' + uStatus, () => {\r\n                navigate('/admin/users')\r\n              })\r\n            } else {\r\n              navigate('/admin/users')\r\n            }\r\n          }\r\n        })\r\n        .catch(error => {\r\n          this.setState({ \r\n            showLoader: false,\r\n            showError:true,\r\n            message: error.toString()\r\n           })\r\n        })      \r\n  }\r\n\r\n  formFields (val,placeholder) {\r\n    for (let i = 0; i < formFields.length; i++) {\r\n      if (formFields[i].placeholder == placeholder){\r\n        formFields[i].value = val \r\n      }\r\n    }\r\n  }\r\n\r\n  onSave = () => {\r\n    const token = localStorage.getItem('token');\r\n    const userid = localStorage.getItem('userId');\r\n    let urlAPI = API_URL + '/users/';\r\n    if (!this.props.isAdd){\r\n      urlAPI = API_URL + '/admin/users/' + this.state.userID ;\r\n    }\r\n    const beartoken = \"Bearer \" + token;\r\n    const headers = { \r\n      'Authorization': beartoken\r\n    };\r\n\r\n    // verify values\r\n    let fields = formFields    \r\n    let isValid = true;\r\n    let newShowError = {};\r\n    for (let i = 0; i < fields.length; i++) {\r\n      if (!fields[i].value){        \r\n        newShowError[fields[i].name] = \"This field is required\";\r\n        isValid = false;\r\n      } else if (i == 0 && !validator.isEmail(fields[i].value)){\r\n        newShowError[fields[i].name] = \"Invalid Email Address\";\r\n        isValid = false;\r\n      } \r\n    }\r\n\r\n    if (!this.props.isAdd){\r\n      const oldemail = this.props.location.state.email\r\n      let old_array = oldemail.split('@')\r\n      let old_domain = old_array[1]      \r\n      const newemail = fields[0].value\r\n      console.log(\"new domain : \", newemail)\r\n      let new_array = newemail.split('@')\r\n      let new_domain = new_array[1]      \r\n      if (old_domain != new_domain){\r\n        newShowError['email'] = 'Email domain can not be changed'\r\n        isValid = false\r\n      }\r\n    }\r\n\r\n    this.setState({\r\n      showError: newShowError\r\n    })\r\n\r\n    if(!isValid){\r\n      return;\r\n    }\r\n\r\n    var jsprograms = {};\r\n    jsprograms['program1'] = true\r\n    jsprograms['program2'] = true\r\n    jsprograms['program3'] = true\r\n    jsprograms['program4'] = true\r\n    jsprograms['program5'] = true\r\n    jsprograms['program6'] = true\r\n\r\n    var jspermissions = {};\r\n    jspermissions['cards_read'] = true\r\n    jspermissions['cards_order'] = true\r\n    jspermissions['cards_edit'] = true\r\n    jspermissions['cards_print'] = true\r\n    jspermissions['cards_reject'] = true\r\n    jspermissions['nfc_write'] = true\r\n\r\n    const body = {\r\n      user_id: this.state.userID,\r\n      user_email: formFields[0].value,\r\n      first_name: formFields[1].value,\r\n      last_name: formFields[2].value,\r\n      user_status: this.props.isAdd ? 'enabled' : this.state.status,\r\n      user_permissions: jspermissions,\r\n      user_programs: jsprograms,\r\n      user_role: 'Administrator',\r\n      created_user: userid,\r\n      modified_user: userid\r\n    };\r\n\r\n    console.log(\"body : \", body)\r\n\r\n    if (this.props.isAdd) { // create user   \r\n      this.setState({ showLoader: true })\r\n      axios\r\n        .post(urlAPI, body, { headers })\r\n        .then(response => {\r\n          console.log(\"response : \", response)\r\n          this.setState({ showLoader: false })\r\n          if(response.data.status ==='unauthorized'){\r\n            this.setState({\r\n              showError:true, \r\n              message: response.data.message.toString()\r\n            })\r\n          } else{\r\n            if (this.alertRef.current) {\r\n              this.alertRef.current.showDialog('', 'New user is created', () => {\r\n                navigate('/admin/users')\r\n              })\r\n            } else {\r\n              navigate('/admin/users')\r\n            }\r\n          }\r\n        })\r\n        .catch(error => {\r\n          console.log(\"error : \", error)\r\n          this.setState({ \r\n            showLoader: false,\r\n            showError:true,\r\n            message: error.toString()\r\n           })\r\n        })\r\n    } else {\r\n      this.setState({ showLoader: true })\r\n      axios.put(urlAPI, body, { headers })\r\n        .then(response => {\r\n          this.setState({ \r\n            showLoader: false\r\n           })\r\n          if(response.data.status ==='unauthorized'){\r\n            this.setState({\r\n              showError:true,\r\n              message: response.data.message.toString()\r\n            })\r\n          } else{\r\n            if (this.alertRef.current) {\r\n              this.alertRef.current.showDialog('', 'User information is updated', () => {\r\n                navigate('/admin/users')\r\n              })\r\n            } else {\r\n              navigate('/admin/users')\r\n            }\r\n          }\r\n        })\r\n        .catch(error => {\r\n          this.setState({ \r\n            showLoader: false,\r\n            showError:true,\r\n            message: error.toString()\r\n           })\r\n        })  \r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      userData,\r\n      classes,\r\n      transitionDuration,\r\n      isDesktop,\r\n      isAdd,\r\n    } = this.props\r\n\r\n    const buttonWidth = isDesktop ? '50%' : 120\r\n\r\n    const btnStyle = {\r\n      width: buttonWidth,\r\n      float: 'right',\r\n      marginLeft: 5,\r\n      marginRight: 5,\r\n      marginBottom: 20,\r\n      minWidth: 180,\r\n    }\r\n\r\n    const rightGridStyle = isDesktop\r\n      ? {\r\n          minWidth: 150,\r\n        }\r\n      : {\r\n          minWidth: '90vw',\r\n        }\r\n    return (\r\n      <MainLayout\r\n        menuIndex={this.props.menuIndex}\r\n        loader={this.state.showLoader}\r\n      >\r\n        <Grid\r\n          container\r\n          justify=\"center\"\r\n          spacing={2}\r\n          style={{ minHeight: '100%' }}\r\n        >\r\n          <Grid\r\n            item\r\n            sm={4}\r\n            xs={12}\r\n            className={classes.cardViewGridLeft}\r\n            style={{\r\n              display:\r\n                !this.props.isAdd ? 'inherit' : 'none',\r\n            }}\r\n          >\r\n            {!this.props.isAdd ? (\r\n              <div style={{ marginTop: 20, paddingLeft: 20 }}>\r\n                <div>\r\n                  <Typography variant=\"body1\">User ID: {this.state.userID}</Typography>\r\n                </div>\r\n                <div style={{ marginTop: 5, marginBottom: 5 }}>\r\n                  <Typography variant=\"body1\">Created: {this.state.user_created_date}</Typography>\r\n                </div>\r\n                <div>\r\n                  <Typography variant=\"body1\">Status: {this.state.status}</Typography>\r\n                </div>\r\n              </div>\r\n            ) : null}\r\n          </Grid>\r\n          <Grid\r\n            item\r\n            md={5}\r\n            sm={12}\r\n            xs={12}\r\n            className={classes.cardViewGrid}\r\n            style={{ marginRight: 5 }}\r\n          >\r\n            <Paper style={{ padding: '0 10px' }} elevation={0}>\r\n              {formFields.map((one, index) => {\r\n                let showErr = this.state.showError[one.name];\r\n                return (\r\n                  <FilledTextInput\r\n                  key={Utils.getKey()}\r\n                  label={one.label}\r\n                  type={one.type}\r\n                  value ={one.value}\r\n                  name={one.name}\r\n                  placeholder={one.placeholder}\r\n                  showError={showErr} \r\n                  formFields ={this.formFields.bind(this)}\r\n                  />\r\n                )\r\n              })}\r\n            </Paper>\r\n          </Grid>\r\n          <Grid\r\n            item\r\n            md={3}\r\n            sm={12}\r\n            className={classes.cardViewGrid}\r\n            style={rightGridStyle}\r\n          >\r\n            <Paper\r\n              style={{\r\n                padding: 10,\r\n                display: 'flex',\r\n                width: '100%',\r\n\r\n                flexDirection: isDesktop ? 'column' : 'row',\r\n                justifyContent: 'center',\r\n                alignItems: isDesktop ? 'stretch' : 'center',\r\n                flexWrap: isDesktop ? 'nowrap' : 'wrap',\r\n              }}\r\n              elevation={0}\r\n            >\r\n              <div>\r\n                {this.props.isAdd ? \r\n                      <Button\r\n                        variant=\"contained\"\r\n                        size=\"medium\"\r\n                        color=\"primary\"\r\n                        style={btnStyle}\r\n                        onClick={this.onSave}\r\n                      > Create </Button> : \r\n                      <Button\r\n                      variant=\"contained\"\r\n                      size=\"medium\"\r\n                      color=\"primary\"\r\n                      style={btnStyle}\r\n                      onClick={this.onSave}\r\n                    > Update </Button>}\r\n              </div>\r\n\r\n              {this.props.isAdd ? null : (\r\n                <>\r\n                  <div>\r\n                    <Button\r\n                      variant=\"contained\"\r\n                      size=\"medium\"\r\n                      color=\"primary\"\r\n                      style={btnStyle}\r\n                      onClick={this.handleReset}\r\n                    >\r\n                      Reset password\r\n                    </Button>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <Button\r\n                      variant=\"contained\"\r\n                      size=\"medium\"\r\n                      color={this.state.disabledUser ? 'primary' : 'secondary'}\r\n                      style={btnStyle}\r\n                      onClick={this.handleStatus}\r\n                    >\r\n                      {this.state.disabledUser ? 'Enable User' : 'Disable User'}\r\n                    </Button>\r\n                  </div>\r\n                </>\r\n              )}\r\n            </Paper>\r\n          </Grid>\r\n        </Grid>\r\n\r\n        <AlertDialog ref={this.alertRef} okTitle={'done'} />\r\n      </MainLayout>\r\n    )\r\n  }\r\n}\r\n\r\nexport default function(props) {\r\n  const dispatch = useDispatch()\r\n  const userData = useSelector(state => state.app.userData)\r\n  const classes = useStyles()\r\n\r\n  const theme = useTheme()\r\n  const transitionDuration = {\r\n    enter: theme.transitions.duration.enteringScreen,\r\n    exit: theme.transitions.duration.leavingScreen,\r\n  }\r\n\r\n  // const isDesktop = useMediaQuery(theme.breakpoints.up('md'))\r\n  const isDesktop = useMediaQuery('(min-width:1053px)')\r\n\r\n  return (\r\n    <UserView\r\n      {...props}\r\n      menuIndex={5}\r\n      isAdd={false}\r\n      dispatch={dispatch}\r\n      isDesktop={isDesktop}\r\n      //   userData={userData}\r\n      classes={classes}\r\n      transitionDuration={transitionDuration}\r\n    />\r\n  )\r\n}\r\n"],"sourceRoot":""}